<!DOCTYPE html>

<html class="writer-html5" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="../../../img/favicon.ico" rel="shortcut icon"/>
<title>Problem 1 - Physics and Mathematics</title>
<link href="../../../css/theme.css" rel="stylesheet"/>
<link href="../../../css/theme_extra.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" rel="stylesheet"/>
<script>
        // Current page data
        var mkdocs_page_name = "Problem 1";
        var mkdocs_page_input_path = "1 Physics/4 Electromagnetism/Problem_1 copy.md";
        var mkdocs_page_url = null;
      </script>
<!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/python.min.js"></script>
<script>hljs.highlightAll();</script>
</head>
<body class="wy-body-for-nav" role="document">
<div class="wy-grid-for-nav">
<nav class="wy-nav-side stickynav" data-toggle="wy-nav-shift">
<div class="wy-side-scroll">
<div class="wy-side-nav-search">
<a class="icon icon-home" href="../../.."> Physics and Mathematics
        </a><div role="search">
<form action="../../../search.html" class="wy-form" id="rtd-search-form" method="get">
<input aria-label="Search docs" name="q" placeholder="Search docs" title="Type search term here" type="text"/>
</form>
</div>
</div>
<div aria-label="Navigation menu" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../..">Introduction</a>
</li>
</ul>
<p class="caption"><span class="caption-text">1 Physics</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal">1 Mechanics</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../1%20Mechanics/Problem_1/">Problem 1</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../1%20Mechanics/Problem_2/">Problem 2</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">2 Gravity</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../2%20Gravity/Problem_1/">Problem 1</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../2%20Gravity/Problem_2/">Problem 2</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../2%20Gravity/Problem_3/">Problem 3</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">3 Waves</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../3%20Waves/Problem_1/">Problem 1</a>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal current">4 Electromagnetism</a>
<ul class="current">
<li class="toctree-l2 current"><a class="reference internal current" href="#">Problem 1</a>
<ul class="current">
<li class="toctree-l3"><a class="reference internal" href="#1-exploration-of-applications">1. Exploration of Applications</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#11-fundamental-equation">1.1 Fundamental Equation</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#12-real-world-applications">1.2 Real-World Applications</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#13-summary-of-field-effects">1.3 Summary of Field Effects</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#2-simulating-particle-motion">2. Simulating Particle Motion</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#21-governing-equation">2.1 Governing Equation</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#22-numerical-implementation">2.2 Numerical Implementation</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#24-boris-algorithm-implementation-alternative-to-euler">2.4 Boris Algorithm Implementation (Alternative to Euler)</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#25-types-of-motion">2.5 Types of Motion</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#3-parameter-exploration">3. Parameter Exploration</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#31-key-parameters-and-their-effects">3.1 Key Parameters and Their Effects</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#32-visual-exploration-goals">3.2 Visual Exploration Goals</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#33-real-world-system-example-cyclotron-motion">3.3 Real-World System Example: Cyclotron Motion</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#34-interactive-parameter-exploration-optional-for-jupytercolab">3.4 Interactive Parameter Exploration (Optional for Jupyter/Colab)</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#4-visualization">4. Visualization</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#41-circular-motion-in-xy-plane">4.1 Circular Motion in \(xy\)-Plane</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#42-3d-helical-motion">4.2 3D Helical Motion</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#43-mathbfe-times-mathbfb-drift-motion">4.3 \(\mathbf{E} \times \mathbf{B}\) Drift Motion</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#colab-electromagnetism-problem-1">Colab: Electromagnetism Problem 1</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#summary-of-visual-insights">Summary of Visual Insights</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#5-numerical-implementation">5. Numerical Implementation</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#euler-method-first-order-approximation">Euler Method (First-Order Approximation)</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#runge-kutta-method-4th-order-rk4">Runge-Kutta Method (4th Order, RK4)</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#recommendation">Recommendation</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#numerical-stability">Numerical Stability</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Problem_1/">Problem 1 (Shorted)</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">5 Circuits</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../5%20Circuits/Problem_1.1/">Problem 1</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../5%20Circuits/Problem_1/">Problem 1</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">6 Statistics</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../6%20Statistics/Problem_1/">Problem 1</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../6%20Statistics/Problem_2/">Problem 2</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">7 Measurements</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../7%20Measurements/Problem_1/">Problem 1</a>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">2 Mathematics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../2%20Mathematics/1%20Linear_algebra/">Linear Algebra</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../2%20Mathematics/2%20Analytic_geometry/">Analytic geometry</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../2%20Mathematics/3%20Calculus/">Calculus</a>
</li>
</ul>
<p class="caption"><span class="caption-text">3 Discret Mathematics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal">1 Set Theory and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/1%20Set%20Theory%20and%20.../_02%20Set_Theory/">Set Theory</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/1%20Set%20Theory%20and%20.../_03%20Relations/">Relations</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/1%20Set%20Theory%20and%20.../_04%20Functions/">Functions</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">2 Number Theory and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/2%20Number%20Theory%20and%20.../_05%20Combinatorics/">Combinatorics</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/2%20Number%20Theory%20and%20.../_08%20Number_Theory/">Number Theory</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">3 Recurrence and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/3%20Recurrence%20and%20.../_06%20Sequences_and_Series/">Sequences and Series</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/3%20Recurrence%20and%20.../_07%20Induction/">Induction</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/3%20Recurrence%20and%20.../_09%20Recurrence/">Recurrence</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">4 Graph Theory and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/4%20Graph%20Theory%20and%20.../_10%20Graph_Theory/">Graph Theory</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">5 Logic</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/5%20Logic/_01%20Logic/">Logic</a>
</li>
</ul>
</li>
</ul>
</div>
</div>
</nav>
<section class="wy-nav-content-wrap" data-toggle="wy-nav-shift">
<nav aria-label="Mobile navigation menu" class="wy-nav-top" role="navigation">
<i class="fa fa-bars" data-toggle="wy-nav-top"></i>
<a href="../../..">Physics and Mathematics</a>
</nav>
<div class="wy-nav-content">
<div class="rst-content"><div aria-label="breadcrumbs navigation" role="navigation">
<ul class="wy-breadcrumbs">
<li><a aria-label="Docs" class="icon icon-home" href="../../.."></a></li>
<li class="breadcrumb-item">1 Physics</li>
<li class="breadcrumb-item">4 Electromagnetism</li>
<li class="breadcrumb-item active">Problem 1</li>
<li class="wy-breadcrumbs-aside">
</li>
</ul>
<hr/>
</div>
<div class="document" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
<div class="section" itemprop="articleBody">
<h1 id="problem-1">Problem 1</h1>
<p><strong>Simulating the Lorentz Force</strong></p>
<h2 id="1-exploration-of-applications">1. Exploration of Applications</h2>
<p>The <strong>Lorentz force</strong> describes the motion of a charged particle under the influence of <strong>electric</strong> and <strong>magnetic fields</strong>, and is one of the cornerstones of classical and modern electromagnetism.</p>
<h3 id="11-fundamental-equation">1.1 Fundamental Equation</h3>
<p>The Lorentz force acting on a particle of charge <span class="arithmatex">\(q\)</span> moving with velocity <span class="arithmatex">\(\mathbf{v}\)</span> in an electric field <span class="arithmatex">\(\mathbf{E}\)</span> and magnetic field <span class="arithmatex">\(\mathbf{B}\)</span> is given by:</p>
<div class="arithmatex">\[
\mathbf{F} = q\mathbf{E} + q\mathbf{v} \times \mathbf{B}
\]</div>
<p>This vector equation has two key components:</p>
<ul>
<li>The <strong>electric force</strong>: <span class="arithmatex">\(q\mathbf{E}\)</span>, which acts in the direction of the electric field.</li>
<li>The <strong>magnetic force</strong>: <span class="arithmatex">\(q\mathbf{v} \times \mathbf{B}\)</span>, which acts perpendicular to both the velocity of the particle and the magnetic field.</li>
</ul>
<hr/>
<h3 id="12-real-world-applications">1.2 Real-World Applications</h3>
<p>The Lorentz force plays a pivotal role in several technological and scientific domains:</p>
<h4 id="particle-accelerators">• Particle Accelerators</h4>
<p>In <strong>cyclotrons</strong>, <strong>synchrotrons</strong>, and <strong>linear accelerators</strong>, particles are steered and accelerated using electromagnetic fields.</p>
<ul>
<li>
<p>Magnetic fields enforce circular or helical motion:
  $$
  r = \frac{mv}{|q|B}
  $$</p>
</li>
<li>
<p>Electric fields provide kinetic energy:
  $$
  \Delta K = qEd
  $$</p>
</li>
</ul>
<h4 id="mass-spectrometers">• Mass Spectrometers</h4>
<p>Used in chemistry and physics to identify atoms and molecules based on their mass-to-charge ratio.</p>
<h4 id="plasma-confinement-fusion-reactors">• Plasma Confinement (Fusion Reactors)</h4>
<p>In <strong>tokamaks</strong> and <strong>stellarators</strong>, magnetic fields confine high-energy plasma in a donut-shaped chamber.</p>
<hr/>
<h3 id="13-summary-of-field-effects">1.3 Summary of Field Effects</h3>
<table>
<thead>
<tr>
<th>Field Type</th>
<th>Direction of Force</th>
<th>Effect on Motion</th>
</tr>
</thead>
<tbody>
<tr>
<td><span class="arithmatex">\(\mathbf{E}\)</span> only</td>
<td>Parallel to <span class="arithmatex">\(\mathbf{E}\)</span></td>
<td>Linear acceleration or deceleration</td>
</tr>
<tr>
<td><span class="arithmatex">\(\mathbf{B}\)</span> only</td>
<td>Perpendicular to <span class="arithmatex">\(\mathbf{v}\)</span> and <span class="arithmatex">\(\mathbf{B}\)</span></td>
<td>Circular or helical motion</td>
</tr>
<tr>
<td><span class="arithmatex">\(\mathbf{E} \perp \mathbf{B}\)</span></td>
<td>Orthogonal force due to <span class="arithmatex">\(\mathbf{v} \times \mathbf{B}\)</span></td>
<td>Drift or spiral trajectories</td>
</tr>
</tbody>
</table>
<h2 id="2-simulating-particle-motion">2. Simulating Particle Motion</h2>
<h3 id="21-governing-equation">2.1 Governing Equation</h3>
<div class="arithmatex">\[
\mathbf{F} = m \frac{d\mathbf{v}}{dt} = q(\mathbf{E} + \mathbf{v} \times \mathbf{B})
\]</div>
<h3 id="22-numerical-implementation">2.2 Numerical Implementation</h3>
<p>Euler method used initially:
$$
\mathbf{v}<em>{n+1} = \mathbf{v}_n + \frac{q}{m}(\mathbf{E} + \mathbf{v}_n \times \mathbf{B})\Delta t
$$
$$
\mathbf{r}</em>{n+1} = \mathbf{r}_n + \mathbf{v}_n \Delta t
$$</p>
<hr/>
<h3 id="24-boris-algorithm-implementation-alternative-to-euler">2.4 Boris Algorithm Implementation (Alternative to Euler)</h3>
<pre><code class="language-python"># Boris algorithm for stable motion in magnetic fields
q, m = 1.0, 1.0
B = np.array([0, 0, 1.0])
E = np.array([0.0, 0.0, 0.0])
v0 = np.array([1.0, 0.0, 0.0])
r0 = np.array([0.0, 0.0, 0.0])
dt, T = 0.01, 10
N = int(T / dt)

r = np.zeros((N, 3))
v = np.zeros((N, 3))
r[0], v[0] = r0, v0

t = (q * B / m) * (dt / 2)
t_mag2 = np.dot(t, t)
s = 2 * t / (1 + t_mag2)

for i in range(N - 1):
    v_minus = v[i] + (q * E / m) * (dt / 2)
    v_prime = v_minus + np.cross(v_minus, t)
    v_plus = v_minus + np.cross(v_prime, s)
    v[i + 1] = v_plus + (q * E / m) * (dt / 2)
    r[i + 1] = r[i] + v[i + 1] * dt
</code></pre>
<hr/>
<h3 id="25-types-of-motion">2.5 Types of Motion</h3>
<h4 id="circular-motion">• Circular Motion</h4>
<p>Occurs when:
- <span class="arithmatex">\(\mathbf{E} = 0\)</span>
- <span class="arithmatex">\(\mathbf{v} \perp \mathbf{B}\)</span></p>
<p>Result:
- Constant-speed circular motion in the plane perpendicular to <span class="arithmatex">\(\mathbf{B}\)</span></p>
<h4 id="helical-motion">• Helical Motion</h4>
<p>Occurs when:
- <span class="arithmatex">\(\mathbf{v}\)</span> has both parallel and perpendicular components with respect to <span class="arithmatex">\(\mathbf{B}\)</span>
- <span class="arithmatex">\(\mathbf{E} = 0\)</span> or parallel to <span class="arithmatex">\(\mathbf{B}\)</span></p>
<p>Result:
- Particle moves in a <strong>spiral</strong> (helix) along field lines with pitch determined by <span class="arithmatex">\(v_\parallel\)</span></p>
<h4 id="drift-motion">• Drift Motion</h4>
<p>Occurs under:
- <span class="arithmatex">\(\mathbf{E} \perp \mathbf{B}\)</span></p>
<p>Result:
- Circular/helical motion superimposed with <strong>uniform drift</strong>:</p>
<p>$$
  \mathbf{v}_\text{drift} = \frac{\mathbf{E} \times \mathbf{B}}{B^2}
  $$</p>
<hr/>
<p>These simulations are vital in visualizing how charged particles behave in various field environments, providing insights into devices such as <strong>mass spectrometers</strong>, <strong>magnetic confinement systems</strong>, and <strong>beam control in accelerators</strong>.</p>
<hr/>
<h2 id="3-parameter-exploration">3. Parameter Exploration</h2>
<p>The dynamics of charged particles under the Lorentz force are highly sensitive to physical parameters. Exploring variations in these parameters allows us to understand how they shape the trajectory and motion characteristics such as speed, curvature, and drift.</p>
<p>The Lorentz force remains our starting point:</p>
<div class="arithmatex">\[
\mathbf{F} = q(\mathbf{E} + \mathbf{v} \times \mathbf{B})
\]</div>
<p>This governs the acceleration and thus the trajectory of the particle according to Newton's second law:</p>
<div class="arithmatex">\[
\mathbf{F} = m \frac{d\mathbf{v}}{dt}
\]</div>
<hr/>
<h3 id="31-key-parameters-and-their-effects">3.1 Key Parameters and Their Effects</h3>
<h4 id="electric-field-strength-e">• Electric Field Strength (<span class="arithmatex">\(E\)</span>)</h4>
<p>The electric field contributes directly to <strong>linear acceleration</strong>:</p>
<div class="arithmatex">\[
\mathbf{a}_E = \frac{q\mathbf{E}}{m}
\]</div>
<ul>
<li><strong>Stronger <span class="arithmatex">\(E\)</span></strong> leads to higher linear acceleration.</li>
<li>Dominant in configurations where <span class="arithmatex">\(\mathbf{B} = 0\)</span> or <span class="arithmatex">\(\mathbf{v} \parallel \mathbf{E}\)</span>.</li>
<li>In combined fields, <span class="arithmatex">\(E\)</span> affects <strong>drift velocity</strong> and can induce <strong>helical stretching</strong>.</li>
</ul>
<hr/>
<h4 id="magnetic-field-strength-b">• Magnetic Field Strength (<span class="arithmatex">\(B\)</span>)</h4>
<p>The magnetic component of the Lorentz force is velocity-dependent:</p>
<div class="arithmatex">\[
\mathbf{F}_B = q(\mathbf{v} \times \mathbf{B})
\]</div>
<ul>
<li><strong>Stronger <span class="arithmatex">\(B\)</span></strong> increases the curvature of motion.</li>
<li>In pure <span class="arithmatex">\(\mathbf{B}\)</span> fields, it reduces the <strong>Larmor radius</strong>:</li>
</ul>
<p>$$
  r_L = \frac{mv_\perp}{|q|B}
  $$</p>
<ul>
<li>It also increases the <strong>gyrofrequency</strong>:</li>
</ul>
<p>$$
  \omega_c = \frac{|q|B}{m}
  $$</p>
<p>where <span class="arithmatex">\(\omega_c\)</span> is the <strong>cyclotron frequency</strong>.</p>
<hr/>
<h4 id="initial-velocity-mathbfv">• Initial Velocity (<span class="arithmatex">\(\mathbf{v}\)</span>)</h4>
<ul>
<li>The direction and magnitude of initial velocity define the <strong>geometry</strong> of motion:</li>
<li>Perpendicular to <span class="arithmatex">\(\mathbf{B}\)</span> <span class="arithmatex">\(\rightarrow\)</span> circular motion</li>
<li>Parallel to <span class="arithmatex">\(\mathbf{B}\)</span> <span class="arithmatex">\(\rightarrow\)</span> linear motion</li>
<li>
<p>Mixed components <span class="arithmatex">\(\rightarrow\)</span> helical motion</p>
</li>
<li>
<p><strong>Magnitude</strong> affects:</p>
</li>
<li>Radius of curvature (<span class="arithmatex">\(r_L\)</span> increases with <span class="arithmatex">\(v_\perp\)</span>)</li>
<li>
<p>Speed of drift in crossed fields:</p>
<div class="arithmatex">\[
\mathbf{v}_\text{drift} = \frac{\mathbf{E} \times \mathbf{B}}{B^2}
\]</div>
</li>
</ul>
<hr/>
<h4 id="particle-charge-q">• Particle Charge (<span class="arithmatex">\(q\)</span>)</h4>
<p>Charge affects both magnitude and direction of the Lorentz force:</p>
<ul>
<li><strong>Sign of <span class="arithmatex">\(q\)</span></strong> reverses the direction of the magnetic force:</li>
</ul>
<p>$$
  \text{If } q &gt; 0: \text{ right-hand rule applies} \
  \text{If } q &lt; 0: \text{ reverse direction (left-hand motion)}
  $$</p>
<ul>
<li>Affects radius and frequency as:</li>
</ul>
<p>$$
  r_L \propto \frac{1}{|q|}, \quad \omega_c \propto |q|
  $$</p>
<hr/>
<h4 id="particle-mass-m">• Particle Mass (<span class="arithmatex">\(m\)</span>)</h4>
<ul>
<li><strong>Inversely proportional</strong> to acceleration for a given force:</li>
</ul>
<p>$$
  \mathbf{a} = \frac{\mathbf{F}}{m}
  $$</p>
<ul>
<li>Affects Larmor radius and cyclotron frequency:</li>
</ul>
<p>$$
  r_L \propto m, \quad \omega_c \propto \frac{1}{m}
  $$</p>
<p>Heavier particles exhibit <strong>larger orbits</strong> and <strong>slower rotation</strong> under the same field conditions.</p>
<hr/>
<h3 id="32-visual-exploration-goals">3.2 Visual Exploration Goals</h3>
<p>By varying the above parameters in simulations, one should:</p>
<ul>
<li><strong>Track trajectory changes</strong>: curvature, helical pitch, drift.</li>
<li><strong>Compare motion types</strong>: linear vs circular vs spiral.</li>
<li><strong>Identify scaling laws</strong> for:</li>
<li>Larmor radius: <span class="arithmatex">\(r_L = \frac{mv_\perp}{|q|B}\)</span></li>
<li>Cyclotron frequency: <span class="arithmatex">\(\omega_c = \frac{|q|B}{m}\)</span></li>
</ul>
<p>Parameter exploration is essential for tuning real-world applications, from optimizing cyclotron paths to designing magnetic traps and beamlines.</p>
<hr/>
<h3 id="33-real-world-system-example-cyclotron-motion">3.3 Real-World System Example: Cyclotron Motion</h3>
<p>Proton in a cyclotron:
- <span class="arithmatex">\(B = 1\ \text{T}\)</span>
- <span class="arithmatex">\(v = 1 \times 10^6\ \text{m/s}\)</span></p>
<p>Larmor radius:
$$
    r_L = \frac{mv}{|q|B} = \frac{1.67 \times 10^{-27} \cdot 10^6}{1.6 \times 10^{-19} \cdot 1} \approx 0.0104\ \text{m}
$$</p>
<hr/>
<h3 id="34-interactive-parameter-exploration-optional-for-jupytercolab">3.4 Interactive Parameter Exploration (Optional for Jupyter/Colab)</h3>
<pre><code class="language-python">import ipywidgets as widgets
from IPython.display import display

def update_simulation(B_field=1.0, velocity=1.0):
    # Call a simulation function with updated B and v
    pass

display(widgets.FloatSlider(value=1.0, min=0.1, max=5.0, step=0.1, description='B Field'))
display(widgets.FloatSlider(value=1.0, min=0.1, max=5.0, step=0.1, description='Velocity'))
</code></pre>
<hr/>
<h2 id="4-visualization">4. Visualization</h2>
<p>Visualizing charged particle trajectories under the Lorentz force is critical for developing intuition about their motion in various electromagnetic field configurations. In this section, we use Python and standard scientific libraries to produce labeled, informative 2D and 3D plots that illustrate:</p>
<ul>
<li><strong>Larmor radius</strong> <span class="arithmatex">\(r_L\)</span></li>
<li><strong>Helical pitch</strong> (distance between spiral turns along the field direction)</li>
<li><strong>Drift velocity</strong> <span class="arithmatex">\(\mathbf{v}_\text{drift} = \frac{\mathbf{E} \times \mathbf{B}}{B^2}\)</span></li>
</ul>
<hr/>
<h3 id="41-circular-motion-in-xy-plane">4.1 Circular Motion in <span class="arithmatex">\(xy\)</span>-Plane</h3>
<p>Charged particle moves in a circle under a uniform magnetic field (<span class="arithmatex">\(\mathbf{B}\)</span> along <span class="arithmatex">\(z\)</span>). No electric field; pure cyclotron motion with constant radius and speed.</p>
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from matplotlib.animation import FuncAnimation

# Parameters
q, m = 1.0, 1.0
B = np.array([0, 0, 1.0])
v0 = np.array([1.0, 0.0, 0.0])
r0 = np.array([0.0, 0.0, 0.0])
dt, T = 0.01, 10
N = int(T / dt)

# Calculate trajectory
r = np.zeros((N, 3))
v = np.zeros((N, 3))
r[0], v[0] = r0, v0

for i in range(N - 1):
    F = q * np.cross(v[i], B)
    a = F / m
    v[i + 1] = v[i] + a * dt
    r[i + 1] = r[i] + v[i] * dt

# Create animation
fig, ax = plt.subplots()
ax.set_xlim(-2, 2)
ax.set_ylim(-2, 2)
ax.set_aspect('equal')
line, = ax.plot([], [], lw=2)
point, = ax.plot([], [], 'ro')

def update(i):
    line.set_data(r[:i + 1, 0], r[:i + 1, 1])  # Trajectory line
    point.set_data([r[i, 0]], [r[i, 1]])       # Current point (wrapped in lists)
    return line, point

# Create animation
ani = FuncAnimation(fig, update, frames=N - 1, interval=30, blit=True)

# Display animation inline in Jupyter Notebook
plt.title("Circular Motion in xy-plane (Animated)")
plt.xlabel('x')
plt.ylabel('y')
# plt.grid(True)
# plt.show()

# Save animation as GIF
gif_path = 'circular_motion.gif'
ani.save(gif_path, writer='pillow', fps=30)


# Display GIF in Colab using HTML
with open(gif_path, 'rb') as f:
    gif_data = f.read()
b64_gif = base64.b64encode(gif_data).decode('utf-8')
html = f'&lt;img src="data:image/gif;base64,{b64_gif}"&gt;'
HTML(html)
</code></pre>
<p><img alt="Circular Motion" src="../../../_pics/Physics/4%20Electromagnetism/Problem_1/circular_motion.gif"/></p>
<hr/>
<h3 id="42-3d-helical-motion">4.2 3D Helical Motion</h3>
<p>Particle follows a helical path due to velocity components both parallel and perpendicular to <span class="arithmatex">\(\mathbf{B}\)</span>. Circular motion + forward motion along field lines.</p>
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D
from matplotlib.animation import FuncAnimation
from IPython.display import HTML
import base64
from io import BytesIO

# Parameters
q, m = 1.0, 1.0
B = np.array([0, 0, 1.0])
v0 = np.array([1.0, 0.0, 0.5])  # Initial velocity with z-component for helical motion
r0 = np.array([0.0, 0.0, 0.0])
dt, T = 0.01, 10
N = int(T / dt)

# Calculate trajectory
r = np.zeros((N, 3))
v = np.zeros((N, 3))
r[0], v[0] = r0, v0

for i in range(N - 1):
    F = q * np.cross(v[i], B)
    a = F / m
    v[i + 1] = v[i] + a * dt
    r[i + 1] = r[i] + v[i] * dt

# Create 3D animation
fig = plt.figure()
ax = fig.add_subplot(111, projection='3d')
ax.set_xlim(-2, 2)
ax.set_ylim(-2, 2)
ax.set_zlim(0, 6)
line, = ax.plot([], [], [], lw=2)
point, = ax.plot([], [], [], 'ro')

def update_3d(i):
    # Update line (trajectory)
    line.set_data(r[:i, 0], r[:i, 1])
    line.set_3d_properties(r[:i, 2])
    # Update point (current position)
    point.set_data([r[i, 0]], [r[i, 1]])  # Wrap in lists to provide sequences
    point.set_3d_properties([r[i, 2]])    # Wrap in list to provide sequence
    return line, point

# Create animation
ani = FuncAnimation(fig, update_3d, frames=N - 1, interval=30, blit=False)  # blit=False for 3D

# Set plot labels and title
ax.set_title("3D Helical Motion (Animated)")
ax.set_xlabel('x')
ax.set_ylabel('y')
ax.set_zlabel('z')

# Save animation as GIF
gif_path = 'helical_motion.gif'
ani.save(gif_path, writer='pillow', fps=30)

# Display GIF in Colab using HTML
with open(gif_path, 'rb') as f:
    gif_data = f.read()
b64_gif = base64.b64encode(gif_data).decode('utf-8')
html = f'&lt;img src="data:image/gif;base64,{b64_gif}"&gt;'
HTML(html)
</code></pre>
<p><img alt="Helical Motion" src="../../../_pics/Physics/4%20Electromagnetism/Problem_1/helical_motion.gif"/></p>
<hr/>
<h3 id="43-mathbfe-times-mathbfb-drift-motion">4.3 <span class="arithmatex">\(\mathbf{E} \times \mathbf{B}\)</span> Drift Motion</h3>
<p>In crossed electric and magnetic fields, the particle spirals while drifting uniformly perpendicular to both <span class="arithmatex">\(\mathbf{E}\)</span> and <span class="arithmatex">\(\mathbf{B}\)</span>.</p>
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from matplotlib.animation import FuncAnimation
from IPython.display import HTML
import base64
from io import BytesIO

# Parameters
q, m = 1.0, 1.0
E = np.array([1.0, 0.0, 0.0])  # Electric field
B = np.array([0.0, 0.0, 1.0])  # Magnetic field
r0 = np.array([0.0, 0.0, 0.0])
v0 = np.array([0.5, 0.0, 0.0])  # Initial velocity
dt, T = 0.01, 10
N = int(T / dt)

# Calculate trajectory
r = np.zeros((N, 3))
v = np.zeros((N, 3))
r[0], v[0] = r0, v0

for i in range(N - 1):
    F = q * (E + np.cross(v[i], B))  # Lorentz force with E and B fields
    a = F / m
    v[i + 1] = v[i] + a * dt
    r[i + 1] = r[i] + v[i] * dt

# Calculate E × B drift
drift = np.cross(E, B) / np.dot(B, B)  # Drift velocity: (E × B) / |B|^2

# Create 2D animation
fig, ax = plt.subplots()
ax.set_xlim(0, 10)
ax.set_ylim(-2, 2)
ax.set_aspect('equal')
line, = ax.plot([], [], lw=2, label='Trajectory')
point, = ax.plot([], [], 'ro', label='Particle')
drift_line, = ax.plot([], [], 'r--', label='Drift')

def update_drift(i):
    # Update trajectory line
    line.set_data(r[:i, 0], r[:i, 1])
    # Update particle position
    point.set_data([r[i, 0]], [r[i, 1]])  # Wrap in lists to provide sequences
    # Update drift line
    if i &gt; 1:  # Ensure enough points for linspace
        t = np.linspace(0, r[i, 0], 50)  # Use fixed number of points for smoothness
        drift_y = drift[1] * t + r[0, 1]  # Drift along y-axis
        drift_line.set_data(t, drift_y)
    else:
        drift_line.set_data([], [])  # Empty data for initial frames
    return line, point, drift_line

# Create animation
ani = FuncAnimation(fig, update_drift, frames=N - 1, interval=30, blit=True)

# Set plot labels, title, and legend
plt.title("Drift Motion in Crossed E × B Fields (Animated)")
plt.xlabel('x')
plt.ylabel('y')
plt.grid(True)
plt.legend()

# Save animation as GIF
gif_path = 'drift_motion.gif'
ani.save(gif_path, writer='pillow', fps=30)

# Display GIF in Colab using HTML
with open(gif_path, 'rb') as f:
    gif_data = f.read()
b64_gif = base64.b64encode(gif_data).decode('utf-8')
html = f'&lt;img src="data:image/gif;base64,{b64_gif}"&gt;'
HTML(html)
</code></pre>
<p><img alt="Drift Motion" src="../../../_pics/Physics/4%20Electromagnetism/Problem_1/drift_motion.gif"/></p>
<hr/>
<h3 id="colab-electromagnetism-problem-1">Colab: Electromagnetism Problem 1</h3>
<p><a href="https://colab.research.google.com/drive/16Epk_vNwaF5WNNwd9b1NzThMiUeVFneC?usp=sharing">Souce Code</a></p>
<hr/>
<h3 id="summary-of-visual-insights">Summary of Visual Insights</h3>
<ul>
<li><strong>Larmor radius</strong> is determined by the perpendicular velocity component and magnetic field:</li>
</ul>
<p>$$
  r_L = \frac{mv_\perp}{|q|B}
  $$</p>
<ul>
<li><strong>Helical pitch</strong> corresponds to the distance moved in the field direction per revolution:</li>
</ul>
<p>$$
  \text{Pitch} = v_\parallel T = \frac{2\pi m v_\parallel}{|q|B}
  $$</p>
<ul>
<li><strong>Drift velocity</strong> from crossed fields appears as a linear translation of the helix:</li>
</ul>
<p>$$
  \mathbf{v}_{\text{drift}} = \frac{\mathbf{E} \times \mathbf{B}}{B^2}
  $$</p>
<p>These visualizations provide powerful tools to explore particle behavior and validate analytic predictions.</p>
<h2 id="5-numerical-implementation">5. Numerical Implementation</h2>
<p>Simulating the motion of charged particles under electromagnetic forces involves solving <strong>ordinary differential equations (ODEs)</strong> derived from the <strong>Lorentz force law</strong>:</p>
<div class="arithmatex">\[
\mathbf{F} = m\frac{d\mathbf{v}}{dt} = q\left( \mathbf{E} + \mathbf{v} \times \mathbf{B} \right)
\]</div>
<p>This gives a coupled system of first-order ODEs:</p>
<div class="arithmatex">\[
\frac{d\mathbf{v}}{dt} = \frac{q}{m}(\mathbf{E} + \mathbf{v} \times \mathbf{B}), \quad \frac{d\mathbf{r}}{dt} = \mathbf{v}
\]</div>
<p>These equations are <strong>nonlinear</strong> and cannot usually be solved analytically. Therefore, we use numerical methods.</p>
<hr/>
<h3 id="euler-method-first-order-approximation">Euler Method (First-Order Approximation)</h3>
<p>The <strong>Euler method</strong> is the simplest approach, using forward differences:</p>
<div class="arithmatex">\[
\mathbf{v}_{n+1} = \mathbf{v}_n + \frac{q}{m}(\mathbf{E} + \mathbf{v}_n \times \mathbf{B})\Delta t
\]</div>
<div class="arithmatex">\[
\mathbf{r}_{n+1} = \mathbf{r}_n + \mathbf{v}_n \Delta t
\]</div>
<ul>
<li><strong>Pros</strong>: Easy to implement  </li>
<li><strong>Cons</strong>: Low accuracy, error grows with time, unstable for stiff or oscillatory systems</li>
</ul>
<hr/>
<h3 id="runge-kutta-method-4th-order-rk4">Runge-Kutta Method (4th Order, RK4)</h3>
<p>The <strong>RK4 method</strong> offers a much more accurate solution. It approximates the next state using intermediate "slopes":</p>
<p>Let <span class="arithmatex">\(\mathbf{f}(t, \mathbf{y})\)</span> be the derivative function for velocity and position:</p>
<ol>
<li>
<p>Compute intermediate steps:
   $$
   \begin{aligned}
   \mathbf{k}_1 &amp;= f(t_n, \mathbf{y}_n) \
   \mathbf{k}_2 &amp;= f(t_n + \frac{\Delta t}{2}, \mathbf{y}_n + \frac{\Delta t}{2} \mathbf{k}_1) \
   \mathbf{k}_3 &amp;= f(t_n + \frac{\Delta t}{2}, \mathbf{y}_n + \frac{\Delta t}{2} \mathbf{k}_2) \
   \mathbf{k}_4 &amp;= f(t_n + \Delta t, \mathbf{y}_n + \Delta t \mathbf{k}_3)
   \end{aligned}
   $$</p>
</li>
<li>
<p>Update the solution:
   $$
   \mathbf{y}_{n+1} = \mathbf{y}_n + \frac{\Delta t}{6}(\mathbf{k}_1 + 2\mathbf{k}_2 + 2\mathbf{k}_3 + \mathbf{k}_4)
   $$</p>
</li>
</ol>
<p>Where <span class="arithmatex">\(\mathbf{y}\)</span> can represent either <span class="arithmatex">\(\mathbf{r}\)</span> or <span class="arithmatex">\(\mathbf{v}\)</span>.</p>
<ul>
<li><strong>Pros</strong>: Much more accurate and stable than Euler, handles oscillatory behavior well</li>
<li><strong>Cons</strong>: More computationally expensive</li>
</ul>
<hr/>
<h3 id="recommendation">Recommendation</h3>
<ul>
<li>Use <strong>Euler method</strong> for quick visualizations or conceptual understanding.</li>
<li>Use <strong>RK4</strong> or the <strong>Boris method</strong> for precision and stability in realistic physics simulations (e.g., plasma modeling, cyclotron motion, fusion confinement).</li>
</ul>
<hr/>
<h3 id="numerical-stability">Numerical Stability</h3>
<p>Time step size <span class="arithmatex">\(\Delta t\)</span> must be small enough to resolve <strong>gyro-motion</strong>:</p>
<div class="arithmatex">\[
\Delta t \ll \frac{2\pi m}{|q|B} = T_{\text{cyclotron}}
\]</div>
<p>Choosing too large a step causes inaccurate or even unstable results.</p>
</div>
</div><footer>
<div aria-label="Footer Navigation" class="rst-footer-buttons" role="navigation">
<a class="btn btn-neutral float-left" href="../../3%20Waves/Problem_1/" title="Problem 1"><span class="icon icon-circle-arrow-left"></span> Previous</a>
<a class="btn btn-neutral float-right" href="../Problem_1/" title="Problem 1 (Shorted)">Next <span class="icon icon-circle-arrow-right"></span></a>
</div>
<hr/>
<div role="contentinfo">
<!-- Copyright etc -->
</div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
</div>
</div>
</section>
</div>
<div aria-label="Versions" class="rst-versions" role="note">
<span class="rst-current-version" data-toggle="rst-current-version">
<span><a href="../../3%20Waves/Problem_1/" style="color: #fcfcfc">« Previous</a></span>
<span><a href="../Problem_1/" style="color: #fcfcfc">Next »</a></span>
</span>
</div>
<script src="../../../js/jquery-3.6.0.min.js"></script>
<script>var base_url = "../../..";</script>
<script src="../../../js/theme_extra.js"></script>
<script src="../../../js/theme.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
<script src="../../../search/main.js"></script>
<script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>
</body>
</html>
